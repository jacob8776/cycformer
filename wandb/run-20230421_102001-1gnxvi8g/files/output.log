[34m[1mwandb[39m[22m: Downloading large artifact protein-sequences:v0, 83.71MB. 3 files...
[34m[1mwandb[39m[22m:   3 of 3 files downloaded.
Done. 0:0:0.1
  0%|                                                                                      | 0/100 [00:00<?, ?it/s]
loading file:  artifacts/protein-sequences:v0/train_seqs
done.
loading file:  artifacts/protein-sequences:v0/val_seqs
done.
File type:  fasta
done.
# of TRAIN SEQ:   203050
# of VAL SEQ:     100




  4%|â–ˆâ–ˆâ–ˆ                                                                           | 4/100 [00:13<05:13,  3.26s/it]
Traceback (most recent call last):
  File "/Users/wynne/Desktop/jacob/cycformer_git/cycformer/train.py", line 298, in <module>
    main()
  File "/Users/wynne/Desktop/jacob/cycformer_git/cycformer/train.py", line 133, in main
    monte_carlo_dropout(model, val_proteins, filename='cycle_annotations', rounds=50)
  File "/Users/wynne/Desktop/jacob/cycformer_git/cycformer/train.py", line 274, in monte_carlo_dropout
    preds = torch.stack([torch.argmax(model(sample['input_ids'].squeeze(0)).logits, dim=-1)
  File "/Users/wynne/Desktop/jacob/cycformer_git/cycformer/train.py", line 274, in <listcomp>
    preds = torch.stack([torch.argmax(model(sample['input_ids'].squeeze(0)).logits, dim=-1)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/transformers/models/esm/modeling_esm.py", line 1121, in forward
    outputs = self.esm(
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/transformers/models/esm/modeling_esm.py", line 922, in forward
    encoder_outputs = self.encoder(
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/transformers/models/esm/modeling_esm.py", line 622, in forward
    layer_outputs = layer_module(
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/transformers/models/esm/modeling_esm.py", line 549, in forward
    layer_output = self.feed_forward_chunk(attention_output)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/transformers/models/esm/modeling_esm.py", line 560, in feed_forward_chunk
    intermediate_output = self.intermediate(attention_output_ln)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/transformers/models/esm/modeling_esm.py", line 462, in forward
    hidden_states = gelu(hidden_states)
  File "/Users/wynne/opt/anaconda3/envs/cycformer/lib/python3.10/site-packages/transformers/models/esm/modeling_esm.py", line 67, in gelu
    return x * 0.5 * (1.0 + torch.erf(x / math.sqrt(2.0)))
KeyboardInterrupt